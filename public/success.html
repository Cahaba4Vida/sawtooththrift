<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Order confirmed | Sawtooth Thrift</title>
    <link rel="stylesheet" href="/assets/css/styles.css" />
    <script defer src="/assets/js/cart.js"></script>
  </head>
  <body>
    <main class="section">
      <div class="container" style="max-width:640px;">
        <div class="card pad" style="text-align:center;">
          <h1 style="margin-top:0;font-size:2rem;">Order Confirmed</h1>
          <p class="muted">Weâ€™ll begin preparing your order.</p>
          <p class="muted">Check your email for receipt and updates.</p>
          <p class="muted small" id="sessionLine" style="display:none;"></p>
          <div style="margin-top:12px;">
            <a class="btn" href="/#products">Continue Shopping</a>
          </div>
        </div>
      </div>
    </main>

    <div class="container" style="max-width:640px;margin-bottom:24px;text-align:center;">
      <div class="muted small">Secure payments powered by Stripe</div>
    </div>

    <script>
      (function () {
        const sessionId = new URL(window.location.href).searchParams.get("session_id");
        if (!sessionId) return;

        const el = document.getElementById("sessionLine");
        if (el) {
          el.style.display = "block";
          el.textContent = "Order ID: " + sessionId;
        }

        if (window.Cart && typeof window.Cart.clearCart === "function") {
          window.Cart.clearCart();
        }

        fetch('/.netlify/functions/stripe-sync-session', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ sessionId }),
        }).catch(() => {});
      })();
    </script>
  </body>
</html>
